
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ìœ ë ¹ ìš´ë™íšŒ (ìµœì¢… í†µí•©)</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    h1, h3 { text-align: center; }
    .popup { display: none; position: fixed; top: 20%; left: 50%; transform: translateX(-50%);
             padding: 20px; background: white; border: 2px solid black; z-index: 1000; max-width: 90vw; }
    table { border-collapse: collapse; width: 100%; font-size: 1.1em; }
    th, td { padding: 10px; min-width: 40px; text-align: center; border: 1px solid #ccc; }
    button { padding: 10px 16px; margin: 5px; font-size: 1em; }
    select { font-size: 1em; padding: 5px; margin: 2px 0; }
    @media (max-width: 768px) {
      table, th, td { font-size: 0.85em; padding: 6px; }
      button { font-size: 0.9em; padding: 6px 10px; }
      select { font-size: 0.9em; padding: 4px; }
    }
  </style>
</head>
<body>
  <h1>ğŸ‘» ìœ ë ¹ ìš´ë™íšŒ (ìµœì¢… í†µí•©)</h1>
  <div id="app">ê²Œì„ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>

  <div id="teamHintPopup" class="popup">
    <h3 id="teamHintTitle">íŒ€ íŒíŠ¸</h3>
    <ul id="teamHintList"></ul>
    <button onclick="document.getElementById('teamHintPopup').style.display='none'">ë‹«ê¸°</button>
  </div>

  <div id="finalAnswerPopup" class="popup">
    <h3>ğŸ ìµœì¢… ìˆœìœ„</h3>
    <ul id="finalRankingList"></ul>
    <button onclick="document.getElementById('finalAnswerPopup').style.display='none'">ë‹«ê¸°</button>
  </div>

  <script>
    const ghostNames = ["ë“œë¼í˜ë¼", "í”„ë‘ì¼„ìŠˆíƒ€ì¸", "ë‹¬ê±€ê·€ì‹ ", "êµ¬ë¯¸í˜¸", "ì²˜ë…€ê·€ì‹ ", "ëŠ‘ëŒ€ì¸ê°„", "í˜¸ë°•ê·€ì‹ ", "í•´ê³¨"];
    const allHints = [
      "ë“œë¼í˜ë¼ëŠ” êµ¬ë¯¸í˜¸ë³´ë‹¤ ëŠ¦ê²Œ ë„ì°©í–ˆë‹¤.",
      "í”„ë‘ì¼„ìŠˆíƒ€ì¸ì€ 3ë“± ì•ˆì— ë“¤ì§€ ëª»í–ˆë‹¤.",
      "í•´ê³¨ì€ 1ë“±ì´ë‚˜ 2ë“±ì´ë‹¤.",
      "ë‹¬ê±€ê·€ì‹ ì€ í˜¸ë°•ê·€ì‹ ë³´ë‹¤ ì•ì„œ ìˆë‹¤.",
      "ëŠ‘ëŒ€ì¸ê°„ì€ ì¤‘ìœ„ê¶Œì´ë‹¤.",
      "ì²˜ë…€ê·€ì‹ ì€ 4ë“±ë³´ë‹¤ ë‚®ë‹¤.",
      "í”„ë‘ì¼„ìŠˆíƒ€ì¸ì€ í•´ê³¨ë³´ë‹¤ ë’¤ì— ìˆë‹¤.",
      "í˜¸ë°•ê·€ì‹ ì€ ë“œë¼í˜ë¼ë³´ë‹¤ ë¹ ë¥´ë‹¤.",
      "ë‹¬ê±€ê·€ì‹ ì€ 6ë“±ë³´ë‹¤ ë¹ ë¥´ë‹¤.",
      "êµ¬ë¯¸í˜¸ëŠ” ë“œë¼í˜ë¼ë³´ë‹¤ 2ë“± ì´ìƒ ì•ì„œ ìˆë‹¤.",
      "ì²˜ë…€ê·€ì‹ ì€ 7ë“±ì´ë‹¤.",
      "ëŠ‘ëŒ€ì¸ê°„ì€ ë‹¬ê±€ê·€ì‹ ë³´ë‹¤ ëŠ¦ë‹¤.",
      "í”„ë‘ì¼„ìŠˆíƒ€ì¸ì€ ìµœí•˜ìœ„ê¶Œì´ë‹¤.",
      "êµ¬ë¯¸í˜¸ëŠ” 3ë“± ì•ˆì— ìˆë‹¤.",
      "ë“œë¼í˜ë¼ëŠ” ìµœìƒìœ„ê¶Œì´ ì•„ë‹ˆë‹¤.",
      "í•´ê³¨ì€ í˜¸ë°•ê·€ì‹ ë³´ë‹¤ ëŠë¦¬ë‹¤."
    ];

    let teams = [];
    let ghostPositions = {};
    let currentRound = 0;
    let revealedHints = new Set();

    function setupGame() {
      document.getElementById("app").innerHTML = `
        <div>íŒ€ ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš” (2~8)</div>
        <input id="team-count" type="number" min="2" max="8" />
        <button onclick="createTeams()">ë‹¤ìŒ</button>
      `;
    }

    function createTeams() {
      const count = parseInt(document.getElementById("team-count").value);
      if (isNaN(count) || count < 2 || count > 8) return alert("2íŒ€ ì´ìƒ, 8íŒ€ ì´í•˜ë¡œ ì…ë ¥í•˜ì„¸ìš”.");
      let html = `<div>íŒ€ ì´ë¦„ ì…ë ¥</div>`;
      for (let i = 0; i < count; i++) {
        html += `<div>íŒ€ ${i + 1}: <input id="team-${i}" /></div>`;
      }
      html += `<button onclick="selectHints(${count})">ë‹¤ìŒ</button>`;
      document.getElementById("app").innerHTML = html;
    }

    function selectHints(count) {
      teams = [];
      for (let i = 0; i < count; i++) {
        const name = document.getElementById("team-" + i).value.trim();
        if (!name) return alert("íŒ€ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.");
        teams.push({ name: name, hints: [] });
      }
      let limit = (count <= 3 ? 2 : 1);
      let html = `<div>íŒíŠ¸ ì„ íƒ (íŒ€ë‹¹ ${limit}ê°œ)</div>`;
      for (let t = 0; t < teams.length; t++) {
        html += `<div><strong>${teams[t].name}</strong><br/>`;
        for (let h = 0; h < allHints.length; h++) {
          html += `<label><input type="checkbox" name="team-${t}" value="${h}" onchange="limitHint(${t}, ${limit})"> íŒíŠ¸ ${h+1}</label><br/>`;
        }
        html += `</div><hr/>`;
      }
      html += `<button onclick="saveHints(${limit})">ì„ íƒ ì™„ë£Œ</button>`;
      document.getElementById("app").innerHTML = html;
    }

    function limitHint(teamIndex, max) {
      const boxes = document.querySelectorAll(`input[name="team-${teamIndex}"]`);
      const checked = Array.from(boxes).filter(b => b.checked);
      if (checked.length > max) event.target.checked = false;
    }

    function saveHints(max) {
      for (let t = 0; t < teams.length; t++) {
        const selected = Array.from(document.querySelectorAll(`input[name="team-${t}"]`))
          .filter(b => b.checked).map(b => parseInt(b.value));
        if (selected.length !== max) return alert("ëª¨ë“  íŒ€ì´ íŒíŠ¸ë¥¼ ì •í™•íˆ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.");
        teams[t].hints = selected.map(i => allHints[i]);
      }
      showHintButtons();
    }

    function showHintButtons() {
      let html = `<div>íŒíŠ¸ í™•ì¸</div>`;
      teams.forEach(team => {
        html += `<button onclick="showTeamHints('${team.name}')">${team.name} íŒíŠ¸ ë³´ê¸°</button>`;
      });
      html += `<button onclick="startRace()">ë ˆì´ìŠ¤ ì‹œì‘</button>`;
      document.getElementById("app").innerHTML = html;
    }

    function showTeamHints(teamName) {
      const team = teams.find(t => t.name === teamName);
      const ul = document.getElementById("teamHintList");
      ul.innerHTML = "";
      team.hints.forEach(h => {
        const li = document.createElement("li");
        li.textContent = h;
        ul.appendChild(li);
      });
      document.getElementById("teamHintTitle").textContent = teamName + "ì˜ íŒíŠ¸";
      document.getElementById("teamHintPopup").style.display = "block";
    }

    function startRace() {
      ghostPositions = {};
      ghostNames.forEach(g => ghostPositions[g] = 1);
      currentRound = 0;
      showRaceBoard();
    }

    function showRaceBoard() {
      let html = `<h3>ë¼ìš´ë“œ ${currentRound + 1}</h3><table><tr><th>ì¹¸</th>`;
      ghostNames.forEach(g => html += `<th>${g}</th>`); html += "</tr>";
      for (let i = 10; i >= 1; i--) {
        html += `<tr><td>${i}</td>`;
        ghostNames.forEach(g => {
          html += `<td>${ghostPositions[g] === i ? getEmoji(g) : ""}</td>`;
        });
        html += "</tr>";
      }
      html += "</table><br/>";
      html += `<button onclick="nextRound()">ë‹¤ìŒ ë¼ìš´ë“œ</button> `;
      html += `<button onclick="showRandomHint()">ìƒˆë¡œìš´ íŒíŠ¸ ë³´ê¸°</button> `;
      html += `<button onclick="predict()">ìµœì¢… ì˜ˆì¸¡</button>`;
      document.getElementById("app").innerHTML = html;
    }

    function nextRound() {
      if (currentRound >= 4) { predict(); return; }
      ghostNames.forEach(g => {
        ghostPositions[g] += Math.floor(Math.random() * 4);
        if (ghostPositions[g] > 10) ghostPositions[g] = 10;
      });
      currentRound++;
      showRaceBoard();
    }

    function showRandomHint() {
      let remaining = allHints.filter(h => !revealedHints.has(h));
      if (remaining.length === 0) return alert("ëª¨ë“  íŒíŠ¸ ê³µê°œë¨");
      let h = remaining[Math.floor(Math.random() * remaining.length)];
      revealedHints.add(h);
      alert("ë¬´ì‘ìœ„ íŒíŠ¸: " + h);
    }

    function predict() {
      let html = "<h3>ìµœì¢… ìˆœìœ„ ì˜ˆì¸¡</h3>";
      teams.forEach((team, tIdx) => {
        html += `<div style="border:1px solid #ccc; padding:10px; margin-bottom:10px;"><strong>${team.name}</strong><br/>`;
        for (let i = 1; i <= 8; i++) {
          html += `${i}ìœ„: <select id="t${tIdx}-r${i}">` +
            ghostNames.map(g => `<option value="${g}">${g}</option>`).join("") +
            "</select><br/>";
        }
        html += "</div>";
      });
      html += `<button onclick="submitAllPredictions()">ì˜ˆì¸¡ ì œì¶œ</button>`;
      document.getElementById("app").innerHTML = html;
    }

    function submitAllPredictions() {
      let allValid = true;
      teams.forEach((team, tIdx) => {
        const prediction = [];
        for (let i = 1; i <= 8; i++) {
          const val = document.getElementById(`t${tIdx}-r${i}`).value;
          if (prediction.includes(val)) {
            alert(`${team.name} íŒ€ì˜ ì˜ˆì¸¡ì— ì¤‘ë³µì´ ìˆìŠµë‹ˆë‹¤.`);
            allValid = false;
            return;
          }
          prediction.push(val);
        }
        team.prediction = prediction;
      });
      if (!allValid) return;
      doFinalRound();
    }

    function doFinalRound() {
      ghostNames.forEach(g => {
        ghostPositions[g] += Math.floor(Math.random() * 4);
        if (ghostPositions[g] > 10) ghostPositions[g] = 10;
      });
      const actual = Object.entries(ghostPositions).sort((a, b) => b[1] - a[1]).map(x => x[0]);
      let html = "<h3>ğŸ ìµœì¢… ê²°ê³¼ (5ë¼ìš´ë“œ í›„)</h3><ul>";
      actual.forEach((g, i) => { html += `<li>${i + 1}ìœ„: ${g}</li>`; });
      html += "</ul><h4>íŒ€ë³„ ì ìˆ˜</h4><ul>";
      teams.forEach(team => {
        let correct = 0;
        for (let i = 0; i < 8; i++) {
          if (team.prediction[i] === actual[i]) correct++;
        }
        team.score = correct;
        html += `<li>${team.name}: ${correct}ê°œ ë§ì¶¤</li>`;
      });
      html += "</ul>";
      document.getElementById("app").innerHTML = html;
    }

    function getEmoji(name) {
      const map = {
        "ë“œë¼í˜ë¼": "ğŸ§›", "í”„ë‘ì¼„ìŠˆíƒ€ì¸": "ğŸ§Ÿ", "ë‹¬ê±€ê·€ì‹ ": "ğŸ¥š", "êµ¬ë¯¸í˜¸": "ğŸ¦Š",
        "ì²˜ë…€ê·€ì‹ ": "ğŸ‘°â€â™€ï¸", "ëŠ‘ëŒ€ì¸ê°„": "ğŸº", "í˜¸ë°•ê·€ì‹ ": "ğŸƒ", "í•´ê³¨": "ğŸ’€"
      };
      return map[name] || "ğŸ‘»";
    }

    window.onload = setupGame;
  </script>
</body>
</html>
